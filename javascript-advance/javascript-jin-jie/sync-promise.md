# JS 进阶 - 期约与异步函数

### 异步编程

异步编程是一个关注度很高的话题，也是一个很重要的一个知识点，尤其是在JavaScript 这种单线程语言中，为了提高执行效率，异步编程的版本也是不断的演化中。

在早期的ECMAScript的版本中，用回调函数来解决异步操作，但是这种回调函数嵌套的太多（回调地狱），对于代码的维护成本变的异常高，随着ES6版本的出现，在异步编程方向也出现了广受欢迎的一种方案（期约），随着ECMAScript的版本不断迭代，又出现了 异步函数（async function）。

先来看看早期JavaScript是如何实现异步编程的

### 回调

**回调** 这个概念想必已经深入人心了，应用的场景已经非常多了（事件监听、Ajax请求）等等。从什么是 **回调** 呢？

回调其实**就是将来要发生的事**，比如事件监听的回调函数、异步请求的回调函数，这些都是在不确定的将来发生的。在**期约（承诺）**没有出现之前，JavaScript中都是使用回调来处理异步的，也就是**回调是JS的最基本的异步模式。**

**回调存在的问题**

#### **1 .执行顺序**

JS 是一门单线程的语言，在同步代码块上是线性、阻塞式执行的。由于事件循环的存在，异步代码块会暂存在**任务队列**中**，等主线程任务执行完毕之后，会按顺序执行任务队列中的代码块。**

回调函数也是暂存在**任务队列**中，它的执行时非线性、非阻塞式的。因此想要准确的判断回调何时执行，是非常困难的，这样做也容易出现bug。

因此对于我们大脑的思考方式来讲，更需要一种同步的、顺序的、更阻塞的方式来表达异步。

#### 2 .信任问题

信任问题是基于**控制反转（将自己一部分的代码块的控制交给了第三方，第三方的代码或者库并不是由你维护的）**的，因此，这种场景下，是很容易出现信任问题的，如果一些第三方的库存在bug，此时对于你的产品也是有一定的影响的。

因此我们需要一个通用的方案来解决信任问题，不管创建多少回调，都可以复用且没有重复的代码。

随着异步编程的领域的发展，回调也逐渐的暴露出的问题难以更优雅的解决异步，随着ES6 的到来，也出现了一种更高级、功能更加强大的异步模式（期约）。

### 期约

期约（对尚不存在的结果的替身），其应用也就是 `Promise` 





### 异步函数

